<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zam SimÃ¼lasyonu | by emreodabasioglu</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #0a0a0a;
            --game-bg: #141414;
            --border-color: #333;
            --neon-blue: #00f3ff;
            --neon-red: #ff003c;
            --neon-green: #05ffa1;
            --text-main: #e0e0e0;
            --ad-bg: #1a1a1a;
        }

        /* KOPYALAMA ENGELLEME (CSS) */
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: space-between;
            align-items: center;
            overflow: hidden;
            
            /* Metin seÃ§imini engelle */
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+/Edge */
            user-select: none; /* Standard */
        }

        /* --- REKLAM ALANLARI --- */
        .ad-space {
            width: 160px;
            height: 100vh;
            background: var(--ad-bg);
            border-left: 1px solid var(--border-color);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #444;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s;
        }
        .ad-space:hover { background: #222; color: #666; }
        .ad-placeholder { border: 2px dashed #444; padding: 20px; border-radius: 10px; }

        /* --- OYUN KONTEYNERÄ° --- */
        .game-wrapper {
            flex-grow: 1;
            max-width: 1000px;
            height: 90vh;
            background: var(--game-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            position: relative;
            border-radius: 4px;
        }

        /* Ä°MZA (emreodabasioglu) */
        .signature {
            position: absolute;
            bottom: 5px;
            right: 10px;
            font-size: 0.7rem;
            color: #444;
            letter-spacing: 1px;
            z-index: 50;
            opacity: 0.5;
            pointer-events: none;
            font-family: monospace;
        }
        .signature span { color: var(--neon-blue); }

        /* ÃœST: PATRON ODASI */
        .boss-room {
            flex: 6;
            position: relative;
            background: radial-gradient(circle at 50% 80%, #2c3e50 0%, #000 100%);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            border-bottom: 4px solid var(--neon-blue);
        }

        .window-view {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: repeating-linear-gradient(90deg, transparent 0, transparent 40px, rgba(0,0,0,0.8) 40px, rgba(0,0,0,0.8) 42px);
            z-index: 1;
            opacity: 0.3;
        }

        .boss-silhouette {
            z-index: 5;
            width: 300px;
            height: 400px;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.1)); 
        }

        .boss-eyes {
            font-size: 80px;
            opacity: 0.8;
            animation: blink 4s infinite;
        }

        /* ALT: KONTROL PANELÄ° */
        .control-panel {
            flex: 4;
            background: #0f0f0f;
            padding: 20px;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }

        .stats-monitor {
            border: 1px solid var(--border-color);
            background: #000;
            padding: 15px;
            font-family: 'Courier New', monospace;
            color: var(--neon-green);
            text-shadow: 0 0 5px var(--neon-green);
        }
        
        .stat-line { margin-bottom: 15px; }
        .stat-label { font-size: 0.8rem; display: block; margin-bottom: 5px; opacity: 0.7; }
        .bar-container { width: 100%; height: 8px; background: #222; }
        .bar-fill { height: 100%; width: 50%; transition: width 0.5s ease; }
        
        #bpm-display { font-size: 2rem; color: var(--neon-red); text-align: center; margin-top: 10px; animation: pulse 1s infinite; }

        .dialogue-interface {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .dialogue-box {
            background: rgba(255,255,255,0.05);
            border-left: 4px solid var(--neon-blue);
            padding: 15px;
            min-height: 80px;
            font-size: 1.2rem;
            line-height: 1.4;
            position: relative;
        }
        
        .speaker-name { font-size: 0.8rem; color: var(--neon-blue); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 5px; font-weight: bold; }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow-y: auto;
            max-height: 180px;
        }

        .choice-btn {
            background: transparent;
            border: 1px solid #444;
            color: #aaa;
            padding: 12px 20px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
        }

        .choice-btn:hover { border-color: var(--neon-blue); color: #fff; background: rgba(0, 243, 255, 0.05); padding-left: 25px; }
        .choice-btn.risk { border-color: var(--neon-red); }
        .choice-btn.risk:hover { background: rgba(255, 0, 60, 0.1); }

        @keyframes blink { 0%, 90%, 100% { transform: scaleY(1); } 95% { transform: scaleY(0.1); } }
        @keyframes pulse { 0% { opacity: 0.5; transform: scale(0.95); } 50% { opacity: 1; transform: scale(1.05); } 100% { opacity: 0.5; transform: scale(0.95); } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 25% { transform: translate(-3px, 0px) rotate(1deg); } 75% { transform: translate(3px, 0px) rotate(-1deg); } 100% { transform: translate(0,0); } }
        
        .screen-shake { animation: shake 0.3s; }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .hidden { display: none; }
        .typewriter::after { content: '|'; animation: blink 1s infinite; }

    </style>
</head>
<body oncontextmenu="return false;">

    <div class="ad-space">
        <div class="ad-placeholder">REKLAM<br>SOL<br>(160x600)</div>
    </div>

    <div class="game-wrapper" id="game-screen">
        
        <div class="signature">designed by <span>emreodabasioglu</span></div>

        <div id="end-overlay" class="overlay hidden">
            <h1 id="end-title" style="font-size: 3rem; margin: 0; color: var(--neon-blue);">SONUÃ‡</h1>
            <p id="end-desc" style="max-width: 600px; text-align: center; font-size: 1.2rem; color: #ccc;">...</p>
            <button onclick="startGame()" style="margin-top: 30px; padding: 10px 40px; background: var(--neon-blue); border: none; cursor: pointer; font-weight: bold; font-size: 1.2rem;">YENÄ°DEN BAÅžLA</button>
        </div>

        <div class="boss-room">
            <div class="window-view"></div>
            <div class="boss-silhouette">
                <div class="boss-eyes" id="boss-eyes">ðŸ‘€</div>
            </div>
            <div style="width: 100%; height: 50px; background: #000; z-index: 10; border-top: 1px solid #333; display: flex; justify-content: center; padding-top: 10px;">
                <div style="background: #222; color: #fff; padding: 5px 20px; height: 25px; border-radius: 2px; font-size: 0.8rem; letter-spacing: 2px;">BAY PATRON</div>
            </div>
        </div>

        <div class="control-panel">
            <div class="stats-monitor">
                <div class="stat-line">
                    <span class="stat-label">PATRONUN SABRI</span>
                    <div class="bar-container"><div class="bar-fill" id="patience-bar" style="background: var(--neon-blue);"></div></div>
                </div>
                <div class="stat-line">
                    <span class="stat-label">STRES SEVÄ°YESÄ°</span>
                    <div class="bar-container"><div class="bar-fill" id="stress-bar" style="background: var(--neon-red);"></div></div>
                </div>
                <hr style="border-color: #333;">
                <div style="text-align: center;">
                    <span class="stat-label">NABIZ (BPM)</span>
                    <div id="bpm-display">80</div>
                </div>
            </div>

            <div class="dialogue-interface">
                <div class="dialogue-box">
                    <div class="speaker-name" id="speaker-name">SÄ°STEM</div>
                    <span id="dialogue-text" class="typewriter">YÃ¼kleniyor...</span>
                </div>
                <div class="choices-container" id="choices-area">
                </div>
            </div>
        </div>
    </div>

    <div class="ad-space">
        <div class="ad-placeholder">REKLAM<br>SAÄž<br>(160x600)</div>
    </div>

<script>
    // --- GÃœVENLÄ°K Ã–NLEMLERÄ° (Kopyalama ve Ä°ncele Engelleme) ---
    document.addEventListener('keydown', function(e) {
        // F12
        if(e.keyCode == 123) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C
        if(e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74 || e.keyCode == 67)) {
            e.preventDefault();
            return false;
        }
        // Ctrl+U (Kaynak Kodu)
        if(e.ctrlKey && e.keyCode == 85) {
            e.preventDefault();
            return false;
        }
    });
    // -------------------------------------------------------------

    let state = { patience: 100, stress: 10, scene: 'intro' };

    const ui = {
        screen: document.getElementById('game-screen'),
        text: document.getElementById('dialogue-text'),
        speaker: document.getElementById('speaker-name'),
        choices: document.getElementById('choices-area'),
        patienceBar: document.getElementById('patience-bar'),
        stressBar: document.getElementById('stress-bar'),
        bpm: document.getElementById('bpm-display'),
        eyes: document.getElementById('boss-eyes'),
        overlay: document.getElementById('end-overlay'),
        endTitle: document.getElementById('end-title'),
        endDesc: document.getElementById('end-desc')
    };

    const scenarios = {
        intro: {
            speaker: "Ä°Ã‡ SES",
            text: "Bay Patron'un odasÄ±nÄ±n Ã¶nÃ¼ndesin. Ä°Ã§eriden telefonla baÄŸÄ±ran bir ses geliyor. Kira gÃ¼nÃ¼ yaklaÅŸÄ±yor. NabzÄ±n yÃ¼kseliyor.",
            eyes: "ðŸšª", bpm: 90,
            choices: [
                { text: "Derin bir nefes al ve kapÄ±yÄ± Ã§al.", next: "waiting" },
                { text: "KapÄ±yÄ± Ã§almadan dal iÃ§eri. (Cesur)", next: "barge_in", risk: true },
                { text: "KapÄ±nÄ±n aralÄ±ÄŸÄ±ndan dinle.", next: "eavesdrop", risk: true }
            ]
        },
        eavesdrop: {
            speaker: "BAY PATRON (TELEFON)",
            text: "...Evet, evet! Maliyetleri kÄ±smamÄ±z lazÄ±m. Personel azaltÄ±n, gerekirse tuvalet kaÄŸÄ±dÄ±nÄ± bile sayÄ±n! Hahaha! Kapat, biri kapÄ±da.",
            eyes: "ðŸ‘‚", bpm: 110, stress: +20,
            choices: [
                { text: "DuymamÄ±ÅŸ gibi yapÄ±p kapÄ±yÄ± Ã§al.", next: "waiting" },
                { text: "Bu ne biÃ§im konuÅŸma! (Sinirle gir)", next: "angry_start", risk: true }
            ]
        },
        waiting: {
            speaker: "SÄ°STEM",
            text: "KapÄ±yÄ± Ã§aldÄ±n... Ses yok. Bekliyorsun. 1 dakika geÃ§ti. Ä°Ã§eriden klavye sesleri geliyor. Seni bekleterek strese sokmaya Ã§alÄ±ÅŸÄ±yor.",
            eyes: "âŒ›", bpm: 100, stress: +10,
            choices: [
                { text: "Tekrar Ã§al.", next: "enter_room" },
                { text: "Beklemeye devam et. (SabÄ±rlÄ±)", next: "waiting_long" }
            ]
        },
        waiting_long: {
            speaker: "BAY PATRON",
            text: "(KapÄ± aniden aÃ§Ä±lÄ±r) Ne dikiliyorsun orada mumya gibi? Gir iÃ§eri! Vaktim yok.",
            eyes: "ðŸ˜ ", bpm: 120, patience: -10,
            choices: [
                { text: "Kusura bakmayÄ±n efendim, rahatsÄ±z etmek istemedim.", next: "passive_start" },
                { text: "Randevumuz vardÄ± Bay Patron.", next: "assertive_start" }
            ]
        },
        passive_start: {
            speaker: "BAY PATRON",
            text: "Tamam tamam, sÄ±zlanma. GeÃ§ otur ÅŸuraya. Sandalye kÄ±rÄ±k dikkat et. Ee, ne anlatacaksÄ±n?",
            eyes: "ðŸ™„",
            choices: [
                { text: "Konu maaÅŸÄ±m efendim.", next: "topic_money" },
                { text: "Åžirketle ilgili endiÅŸelerim var.", next: "topic_company" }
            ]
        },
        assertive_start: {
            speaker: "BAY PATRON",
            text: "Randevu mu? Haa, doÄŸru. Sekreterim sÃ¶ylemiÅŸti. Cesaretini sevdim, ama vaktim nakittir. HÄ±zlÄ± ol.",
            eyes: "ðŸ¤¨", stress: -5,
            choices: [
                { text: "DoÄŸrudan konuya gireyim: Zam istiyorum.", next: "topic_money" },
                { text: "GeleceÄŸim hakkÄ±nda konuÅŸmak istiyorum.", next: "topic_company" }
            ]
        },
        enter_room: {
            speaker: "BAY PATRON",
            text: "Gel. Oturma, ayakta konuÅŸacaÄŸÄ±z. SÃ¶yle bakalÄ±m, bu yoÄŸunlukta beni neden meÅŸgul ediyorsun?",
            eyes: "ðŸ§", bpm: 110,
            choices: [
                { text: "Asgari Ã¼cret zammÄ± ve performansÄ±m hakkÄ±nda konuÅŸacaktÄ±m.", next: "topic_money" },
                { text: "Åžirketin geleceÄŸi hakkÄ±nda endiÅŸelerim var...", next: "topic_company" }
            ]
        },
        topic_company: {
            speaker: "BAY PATRON",
            text: "Åžirketin geleceÄŸi parlak, sen kendi geleceÄŸini dÃ¼ÅŸÃ¼n. EÄŸer zam isteyeceksen lafÄ± dolandÄ±rma.",
            eyes: "ðŸ•¶ï¸",
            choices: [
                { text: "Evet, zam istiyorum.", next: "topic_money" },
                { text: "HayÄ±r, sadece durum deÄŸerlendirmesi... (Korkak)", next: "coward_loop" }
            ]
        },
        coward_loop: {
            speaker: "BAY PATRON",
            text: "Durum deÄŸerlendirmesini ben yaparÄ±m. Ã‡Ä±kabilirsin, meÅŸgulÃ¼m.",
            choices: [{text: "Peki...", next: "slave_ending"}]
        },
        topic_money: {
            speaker: "BAY PATRON",
            text: "Para... Yine para. Daha geÃ§en yÄ±l zam yapmadÄ±k mÄ±? Åžirket zor durumda. Elektrik faturasÄ± ne kadar geldi haberin var mÄ±?",
            eyes: "ðŸ˜’", bpm: 100,
            choices: [
                { text: "GeÃ§en yÄ±lki zam enflasyonun yarÄ±sÄ±ydÄ± efendim.", next: "logic_battle_1" },
                { text: "Sizin arabanÄ±zÄ±n aylÄ±k taksiti kadar zam istiyorum sadece.", next: "personal_attack", risk: true },
                { text: "Benim kiram %150 arttÄ±, geÃ§inemiyorum.", next: "sympathy_fail" }
            ]
        },
        angry_start: {
             speaker: "BAY PATRON",
             text: "Sen kapÄ± dinlemeyi nerden Ã¶ÄŸrendin? Derhal Ã§Ä±k odamdan! Terbiyesiz!",
             eyes: "ðŸ¤¬", stress: +40, patience: -50, effect: "shake",
             choices: [
                 { text: "Ã–zÃ¼r dilerim...", next: "waiting" },
                 { text: "Ã‡Ä±kmÄ±yorum! HakkÄ±mÄ± verin!", next: "fired_scene" }
             ]
        },
        barge_in: {
            speaker: "BAY PATRON",
            text: "HOOP! BurasÄ± ahÄ±r mÄ±? Ã‡Ä±k dÄ±ÅŸarÄ± tekrar gir! Yoksa gÃ¼venliÄŸi Ã§aÄŸÄ±rÄ±rÄ±m!",
            eyes: "ðŸ¤¬", bpm: 140, stress: +30, patience: -30, effect: "shake",
            choices: [
                { text: "Ã‡Ä±kÄ±p tekrar gir (UtanÃ§ verici)", next: "waiting" },
                { text: "Dinlemek zorundasÄ±nÄ±z!", next: "fired_immediate", risk: true }
            ]
        },
        logic_battle_1: {
            speaker: "BAY PATRON",
            text: "Enflasyon devletin sorunu, benim deÄŸil. Ben performansa bakarÄ±m. GeÃ§en ayki raporda bir virgÃ¼l hatasÄ± vardÄ±. Bu mu performans?",
            eyes: "ðŸ“‰", bpm: 115, stress: +10,
            choices: [
                { text: "O hatayÄ± ben deÄŸil, sistem yaptÄ±. AyrÄ±ca satÄ±ÅŸlarÄ± %20 artÄ±rdÄ±m.", next: "logic_battle_2" },
                { text: "Ã–zÃ¼r dilerim, daha dikkatli olurum... (Alttan al)", next: "slave_ending" }
            ]
        },
        logic_battle_2: {
            speaker: "BAY PATRON",
            text: "SatÄ±ÅŸlar arttÄ± ama kÃ¢rlÄ±lÄ±k dÃ¼ÅŸtÃ¼. Bak, sana bir teklif yapayÄ±m. MaaÅŸÄ±nÄ± aynÄ± tutalÄ±m, ama Ã¼nvanÄ±nÄ± 'Senior Specialist' yapalÄ±m? Kartvizitin havalÄ± olur.",
            eyes: "ðŸ˜", bpm: 105,
            choices: [
                { text: "Ãœnvan kiramÄ± Ã¶demiyor Bay Patron. Nakit istiyorum.", next: "hard_negotiation" },
                { text: "Peki, yanÄ±nda yemek kartÄ± bakiyesini artÄ±rÄ±r mÄ±sÄ±nÄ±z?", next: "compromise_try" }
            ]
        },
        compromise_try: {
            speaker: "BAY PATRON",
            text: "Yemek kartÄ± mÄ±? Tamam, gÃ¼nlÃ¼k 50 TL artÄ±ÅŸ yaparÄ±m. Ama maaÅŸÄ±na zam yok. AnlaÅŸtÄ±k mÄ±?",
            choices: [
                 { text: "HiÃ§ yoktan iyidir. (Kabul Et)", next: "bad_deal_ending" },
                 { text: "Bu yetmez, maaÅŸ zammÄ± ÅŸart.", next: "hard_negotiation" }
            ]
        },
        sympathy_fail: {
            speaker: "BAY PATRON",
            text: "Herkesin derdi kendine. Ben burasÄ± hayÄ±r kurumu mu? Bana para kazandÄ±r, para vereyim. Kirandan bana ne?",
            eyes: "ðŸ˜¤", bpm: 130, patience: -10,
            choices: [
                { text: "Ben de o zaman emeÄŸimi baÅŸka ÅŸirkete satarÄ±m.", next: "ultimatum_scene" },
                { text: "HaklÄ±sÄ±nÄ±z... Ã‡alÄ±ÅŸmaya devam edeceÄŸim.", next: "slave_ending" }
            ]
        },
        personal_attack: {
            speaker: "BAY PATRON",
            text: "Sen benim Ã¶zel hayatÄ±mÄ± mÄ± takip ediyorsun? Haddini bil! Bu konuÅŸma bitmiÅŸtir!",
            eyes: "ðŸ˜¡", bpm: 150, stress: +40, effect: "shake",
            choices: [
                { text: "Ã‡ok ileri gittim, Ã¶zÃ¼r dilerim.", next: "waiting" },
                { text: "Bitmez! HakkÄ±mÄ± verin!", next: "fired_scene" }
            ]
        },
        hard_negotiation: {
            speaker: "BAY PATRON",
            text: "(Masaya vurur) Ã‡ok inatÃ§Ä±sÄ±n! Tamam, %30 zam. Ama Cumartesi gÃ¼nleri de geleceksin ve mesai Ã¼creti yok. Ä°ÅŸine gelirse.",
            eyes: "ðŸ‘€", bpm: 140, stress: +20,
            choices: [
                { text: "Asla! Hafta sonu benim. %25 olsun ama haftasonu bende kalsÄ±n.", next: "smart_win" },
                { text: "Tamam kabul ediyorum... (Ã‡aresiz)", next: "bad_deal_ending" },
                { text: "Ben istifa ediyorum. Bu ÅŸartlarda Ã§alÄ±ÅŸamam.", next: "resign_ending" }
            ]
        },
        ultimatum_scene: {
            speaker: "BAY PATRON",
            text: "Tehdit mi? KapÄ± orada. Senden bin tane var dÄ±ÅŸarÄ±da. Git!",
            eyes: "ðŸ‘‰", bpm: 160, stress: +30,
            choices: [
                { text: "[BLÃ–F] Rakip firma X ile gÃ¶rÃ¼ÅŸtÃ¼m, %50 fazla veriyorlar.", next: "bluff_check", risk: true },
                { text: "Peki, gidiyorum!", next: "fired_scene" }
            ]
        },
        bluff_check: { check: true },
        
        // SONLAR
        fired_immediate: { end: true, title: "KOVULDUN", msg: "Daha odaya girmeden kovulmayÄ± baÅŸardÄ±n. Rekor.", color: "red" },
        fired_scene: { end: true, title: "KOVULDUN", msg: "GÃ¼venlik eÅŸliÄŸinde binadan Ã§Ä±karÄ±ldÄ±n. Tazminat davasÄ± aÃ§acaksÄ±n ama iÅŸ iÅŸten geÃ§ti.", color: "red" },
        slave_ending: { end: true, title: "KÃ–LELÄ°K DEVAM EDÄ°YOR", msg: "Zam alamadÄ±n, sadece azar iÅŸittin. Masana dÃ¶ndÃ¼n ve Ã§alÄ±ÅŸmaya devam ettin.", color: "grey" },
        bad_deal_ending: { end: true, title: "KAYBETTÄ°N", msg: "Zam aldÄ±n ama artÄ±k haftada 6 gÃ¼n Ã§alÄ±ÅŸÄ±yorsun. HayatÄ±n bitti.", color: "orange" },
        smart_win: { end: true, title: "MAKUL ZAFER", msg: "%25 ZammÄ± kopardÄ±n ve hafta sonlarÄ±nÄ± kurtardÄ±n. Patron senden nefret ediyor ama saygÄ± duyuyor.", color: "cyan" },
        resign_ending: { end: true, title: "Ã–ZGÃœRLÃœK", msg: "Ä°stifayÄ± bastÄ±n. Cebinde para yok ama kafan rahat. Belki o reklamdaki iÅŸe baÅŸvurursun?", color: "white" },
        legend_win: { end: true, title: "EFSANEVÄ° ZAFER", msg: "BlÃ¶fÃ¼n tuttu! Seni kaybetmekten korktu. %45 Zam + Prim aldÄ±n.", color: "gold" },
        bluff_fail: { end: true, title: "BLÃ–F PATLADI", msg: "'Yalan sÃ¶ylÃ¼yorsun' dedi ve seni kovdu. KeÅŸke doÄŸruyu sÃ¶yleseydin.", color: "red" }
    };

    function startGame() {
        state.patience = 100;
        state.stress = 20;
        ui.overlay.classList.add('hidden');
        renderStats();
        loadScene('intro');
    }

    function updateStats(pChange, sChange) {
        state.patience = Math.min(100, Math.max(0, state.patience + (pChange || 0)));
        state.stress = Math.min(100, Math.max(0, state.stress + (sChange || 0)));
        renderStats();
    }

    function renderStats() {
        ui.patienceBar.style.width = state.patience + "%";
        ui.stressBar.style.width = state.stress + "%";
        let bpm = 80 + (state.stress * 0.8);
        ui.bpm.innerText = Math.floor(bpm);
        ui.bpm.style.animationDuration = (60 / bpm) + "s";
    }

    function loadScene(key) {
        if (!scenarios[key]) {
            console.error("HATA: Senaryo bulunamadÄ± ->", key);
            return;
        }

        let scene = scenarios[key];
        
        if (scene.check) {
            if (Math.random() > 0.5) loadScene('legend_win');
            else loadScene('bluff_fail');
            return;
        }

        if (scene.end) {
            ui.endTitle.innerText = scene.title;
            ui.endTitle.style.color = scene.color === 'gold' ? '#ffd700' : (scene.color === 'red' ? '#ff003c' : '#00f3ff');
            ui.endDesc.innerText = scene.msg;
            ui.overlay.classList.remove('hidden');
            return;
        }

        updateStats(scene.patience, scene.stress);
        
        ui.speaker.innerText = scene.speaker || "SÄ°STEM";
        ui.eyes.innerText = scene.eyes || "ðŸ˜¶";
        ui.text.innerText = "";
        
        if (scene.effect === 'shake') {
            ui.screen.classList.add('screen-shake');
            setTimeout(() => ui.screen.classList.remove('screen-shake'), 500);
        }

        let i = 0;
        ui.choices.innerHTML = '';
        function typeWriter() {
            if (i < scene.text.length) {
                ui.text.innerText += scene.text.charAt(i);
                i++;
                setTimeout(typeWriter, 20);
            } else {
                renderChoices(scene.choices);
            }
        }
        typeWriter();
    }

    function renderChoices(choices) {
        choices.forEach(c => {
            let btn = document.createElement('button');
            btn.className = 'choice-btn';
            if (c.risk) btn.classList.add('risk');
            
            let label = c.text;
            if (c.risk) label += " [RÄ°SKLÄ°]";
            
            btn.innerText = "âž¤ " + label;
            btn.onclick = () => loadScene(c.next);
            ui.choices.appendChild(btn);
        });
    }

    startGame();
</script>
</body>
</html>